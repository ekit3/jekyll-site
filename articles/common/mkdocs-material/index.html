
<!doctype html>
<html>
    <head>
        <meta name="theme-color" content="#000000"/>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Créer un site web de documentation statique avec MkDocs</title>
        <link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
        <link rel="stylesheet" href="/assets/css/select2.min.css" />
        <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Bienvenue sur le Blog d'Ekite" />
        <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="/css/main.css" />
        <link rel="icon" href="/assets/images/favicon.png" href="logo.png" />
        <link rel="manifest" href="/manifest.webmanifest">
        
            <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-D332437KRM"
></script>
<script>

    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    var tagAnalyticsCNIL = {};

    tagAnalyticsCNIL.CookieConsent = (function () {
    var gaProperty = "G-D332437KRM";
    // Désactive le tracking si le cookie d’Opt-out existe déjà.
    var disableStr = `ga-disable-${gaProperty}`;
    var firstCall = false;
    var domaineName = "";

    //Cette fonction retourne la date d’expiration du cookie de consentement

    function getCookieExpireDate() {
        var cookieTimeout = 33696000000; // Le nombre de millisecondes que font 13 mois
        var date = new Date();
        date.setTime(date.getTime() + cookieTimeout);
        var expires = "; expires=" + date.toGMTString();
        return expires;
    }

    function getDomainName() {
        if (domaineName != "") {
            return domaineName;
        } else {
            var hostname = document.location.hostname;
            if (hostname.indexOf("www.") === 0) hostname = hostname.substring(4);
            return hostname;
        }
    }

    //Cette fonction définie le périmétre du consentement ou de l'opposition  (en fonction du domaine)
    //Par défaut nous considérons que le domaine est tout ce qu'il y'a aprés  "www"
    function getCookieDomainName() {
        var hostname = getDomainName();
        var domain = "domain=" + "." + hostname;
        return domain;
    }

    //Cette fonction vérifie si on  a déjà obtenu le consentement de la personne qui visite le site
    function checkFirstVisit() {
        var consentCookie = getCookie("hasConsent");
        if (!consentCookie) return true;
    }

    function showBanner() {
        var bodytag = document.getElementsByTagName("body")[0];
        var div = document.createElement("div");
        div.setAttribute('id','cookie-banner');
        div.style.width = window.innerWidth + "px";
        div.style.height = window.innerHeight + "px";
        div.style.position = "fixed";
        div.style.zIndex = "100000";
        div.style.backgroundColor = "#11111190"
        div.innerHTML = `
                <div style="width: 300px; 1px solid #2F343A; border-radius: 5px; background-color: #f1f1f1; repeat scroll 0% 0% white; padding :10px 10px;text-align:center; position: fixed; top:30px; left:50%; margin-top:0px; margin-left:-150px; z-index:100000; id="inform-and-consent">
                    <div>
                        <span><b>Ce site utilise Google Analytics</b></span><br/><br/>
                        En continuant à naviguer, vous nous autorisez à déposer un cookie à des fins de mesure d'audience.
                    </div>
                    <div style="padding :20px;text-align:center;">
                    <button 
                        style="margin-right:50px;"
                        class="btn btn-light"
                        name="Refuser"
                        onclick="tagAnalyticsCNIL.CookieConsent.gaOptout();tagAnalyticsCNIL.CookieConsent.hideInform();"
                        id="optout-button">
                        Refuser
                    </button>
                    <button
                        id="accept-ga"
                        name="Valider"
                        class="btn btn-success"
                        onclick="tagAnalyticsCNIL.CookieConsent.hideInform()">
                        Accepter
                    </button>
                    </div>
                </div>
            `;
      bodytag.insertBefore(div, bodytag.firstChild);
    }

    // Fonction utile pour récupérer un cookie a partire de son nom
    function getCookie(NameOfCookie) {
        if (document.cookie.length > 0) {
            begin = document.cookie.indexOf(NameOfCookie + "=");
            if (begin != -1) {
            begin += NameOfCookie.length + 1;
            end = document.cookie.indexOf(";", begin);
            if (end == -1) end = document.cookie.length;
            return unescape(document.cookie.substring(begin, end));
            }
        }
        return null;
    }

    //Récupère la version d'Internet Explorer, si c'est un autre navigateur la fonction renvoie -1
    function getInternetExplorerVersion() {
        var rv = -1;
        if (navigator.appName == "Microsoft Internet Explorer") {
            var ua = navigator.userAgent;
            var re = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null) rv = parseFloat(RegExp.$1);
        } else if (navigator.appName == "Netscape") {
            var ua = navigator.userAgent;
            var re = new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null) rv = parseFloat(RegExp.$1);
        }
        return rv;
    }

    //Effectue une demande de confirmation de DNT pour les utilisateurs d'IE
    function askDNTConfirmation() {
        var r = confirm(
            "La signal DoNotTrack de votre navigateur est activé, confirmez vous activer la fonction DoNotTrack?"
        );
        return r;
    }

    //Vérifie la valeur de navigator.DoNotTrack pour savoir si le signal est activé et est à 1
    function notToTrack() {
        if (
            (navigator.doNotTrack &&
            (navigator.doNotTrack == "yes" || navigator.doNotTrack == "1")) ||
            (navigator.msDoNotTrack && navigator.msDoNotTrack == "1")
        ) {
            var isIE = getInternetExplorerVersion() != -1;
            if (!isIE) {
            return true;
            } else {
            return askDNTConfirmation();
            }
            return false;
        }
    }

    //Si le signal est à 0 on considére que le consentement a déjà été obtenu
    function isToTrack() {
      if (
        navigator.doNotTrack &&
        (navigator.doNotTrack == "no" || navigator.doNotTrack == 0)
      ) {
        return true;
      }
    }

    // Fonction d'effacement des cookies
    function delCookie(name) {
      var path = ";path=" + "/";

      var expiration = "Thu, 01-Jan-1970 00:00:01 GMT";
      document.cookie = `${name}=${path} ; ${getCookieDomainName()} ;expires=${expiration}`;
    }

    // Efface tous les types de cookies utilisés par Google Analytics
    function deleteAnalyticsCookies() {
      var cookieNames = ["__utma", "__utmb", "__utmc", "__utmz", "_ga", "_gat"];
      for (var i = 0; i < cookieNames.length; i++) delCookie(cookieNames[i]);
    }

    function isClickOnOptOut(evt) {
      // Si le noeud parent ou le noeud parent du parent est la banniére, on ignore le clic
      return (
        evt.target.parentNode.id == "cookie-banner" ||
        evt.target.parentNode.parentNode.id == "cookie-banner" ||
        evt.target.id == "optout-button"
      );
    }

    function consent(evt) {
      if (!isClickOnOptOut(evt)) {
        // On vérifie qu'il ne s'agit pas d'un clic sur la banniére
        if (!clickprocessed) {
         evt.preventDefault();
         closeModalAfterClickProcessed();
        }
      }
      if(evt.target.id === 'accept-ga'){
        evt.preventDefault();
          document.cookie = `hasConsent=true ${getCookieExpireDate()} ${getCookieDomainName()} path=/`;
          callGoogleAnalytics();
          closeModalAfterClickProcessed();
        }
    }

    function closeModalAfterClickProcessed(){
        clickprocessed = true;
        window.setTimeout(function () {
        evt.target.click();
        }, 1000);
        tagAnalyticsCNIL.CookieConsent.hideInform();
    }

    // Tag Google Analytics, cette version est avec le tag Universal Analytics
    function callGoogleAnalytics() {
        if (firstCall) return;
        else firstCall = true;

        gtag("js", new Date());
        gtag("config", gaProperty);

        (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
            i[r] ||
            function () {
                (i[r].q = i[r].q || []).push(arguments);
            }),
            (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
        })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
        );
        ga("create", gaProperty, "auto"); // Replace with your property ID.
        ga("send", "pageview", "/articles/common/mkdocs-material/");
    }

    return {
        // La fonction d'opt-out
        gaOptout: function () {
            document.cookie = `${disableStr}=true ${getCookieExpireDate()} ${getCookieDomainName()} path=/`;
            document.cookie = `hasConsent=false ${getCookieExpireDate()} ${getCookieDomainName()} path=/`;
            var div = document.getElementById("cookie-banner");
            // on considère que le site a été visité
            clickprocessed = true;
            // Ci dessous le code de la bannière affichée une fois que l'utilisateur s'est opposé au dépot
            // Vous pouvez modifier le contenu et le style
            if (div != null)
            div.innerHTML =
                '<div style="background-color:#fff;text-align:center;padding:5px;font-size:12px;border-bottom:1px solid #eeeeee;" id="cookie-message"> Vous vous êtes opposé \
                au dépôt de cookies de mesures d\'audience dans votre navigateur </div>';
            window[disableStr] = true;
            deleteAnalyticsCookies();
        },

        hideInform: function () {
            var div = document.getElementById("cookie-banner");
            div.style.display = "none";
        },

        start: function () {
            //Ce bout de code vérifie que le consentement n'a pas déjà été obtenu avant d'afficher
            // la bannière
            var consentCookie = getCookie("hasConsent");
            clickprocessed = false;
            if (!consentCookie) {
            //L'utilisateur n'a pas encore de cookie, on affiche la banniére et si il clique sur un autre élément que la banniére, on enregistre le consentement
            if (notToTrack()) {
                //L'utilisateur a activé DoNotTrack. Do not ask for consent and just opt him out
                tagAnalyticsCNIL.CookieConsent.gaOptout();
            } else {
                if (isToTrack()) {
                //DNT is set to 0, no need to ask for consent just set cookies
                consent();
                } else {
                if (window.addEventListener) {
                    // See note https://github.com/CNILlab/Cookie-consent_Google-Analytics/commit/e323b3be2c4a4d05300e35cdc11102841abdcbc9
                    // Standard browsers
                    window.addEventListener("load", showBanner, false);
                    document.addEventListener("click", consent, false);
                } else {
                    window.attachEvent("onload", showBanner);
                    document.attachEvent("onclick", consent);
                }
                }
            }
            } else {
            if (document.cookie.indexOf("hasConsent=false") > -1)
                window[disableStr] = true;
            else callGoogleAnalytics();
            }
        },
    };
  })();

  tagAnalyticsCNIL.CookieConsent.start();
</script>

        
    </head>
    <body>
        <nav class="header">
    <a class="ekite" href="https://www.ekit3.com/" target="_blank"><img alt="logo Ekite" src="/assets/images/logo-ekite.png"></a>
    <a class="link" href="/"><span class="material-icons">roofing</span><span class="a-title">Accueil</span></a>
    <!--<a class="link" href="/pageTest"><span class="material-icons">star_border</span>Page test</a>-->
    <div class="search">
        <select class="search-article">
            <option></option>
            
                <optgroup label="Front-End">
                
                    <option value="/articles/front-end/web-assembly/">Web Assembly</option>
                
                    <option value="/articles/front-end/algebraic-structure/">Les structures algébriques</option>
                
                    <option value="/articles/front-end/micro-front-end/">Micro Front End</option>
                
                    <option value="/articles/front-end/pwa-innovation-or-consolation/">PWA : Innovation ou solution de consolation ?</option>
                
            </optgroup>
            
                <optgroup label="Testing">
                
                    <option value="/articles/testing/mutation-testing/">Mutation testing</option>
                
            </optgroup>
            
                <optgroup label="Green-IT">
                
                    <option value="/articles/green-it/eco-conception/">Eco Conception</option>
                
            </optgroup>
            
                <optgroup label="Other">
                
                    <option value="/articles/other/design-pattern/">Design Pattern</option>
                
            </optgroup>
            
                <optgroup label="Devops">
                
                    <option value="/articles/devops/direnv-pour-votre-shell/">direnv pour booster votre shell</option>
                
                    <option value="/articles/devops/skaffold-et-minikube/">Exécuter une application localement sur minikube avec skaffold</option>
                
            </optgroup>
            
                <optgroup label="Common">
                
                    <option value="/articles/common/mkdocs-material/">Créer un site web de documentation statique avec MkDocs</option>
                
                    <option value="/articles/common/abstract-data-types/">Abstract Data Types</option>
                
            </optgroup>
            
        </select>
    </div>
</nav>

        <main class="page-content" aria-label="Content">
            
  <div class="posts single">
    <button type="button" class="btn btn-dark btn-return" onclick="goBackHistory()">Retour</button>
    <article>
      <h2>Créer un site web de documentation statique avec MkDocs</h2>
      <div class="post-header">
          <span>Ecrit par</span>


    
    
         <a href="http://twitter.com/codekaio">Julien Wittouck</a>,
    


          <span>Publié le 27 Apr 2023</span>
      </div>
      <div class="extract">
          <span></span><h1 id="créer-un-site-web-de-documentation-statique-avec-mkdocs">Créer un site web de documentation statique avec MkDocs</h1>

<p>Que ce soit pour un projet d’entreprise ou un projet open-source, la documentation utilisateur et technique est cruciale.
Dans une documentation d’usage, les utilisateurs doivent pouvoir retrouver les instructions leur permettant d’accomplir les gestes métier de tous les jours.
Pour la documentation technique, les administrateurs, opérateurs et développeurs doivent pouvoir retrouver les opérations d’installation, de mise à jour, ou encore de développement du produit.</p>

<p>La documentation peut prendre plusieurs formes:</p>

<ul>
  <li>un document bureautique, de type LibreOffice Writer ou Microsoft Word</li>
  <li>des pages dans un référentiel documentaire de type <em>wiki</em>, ou <em>Atlassian Confluence</em></li>
  <li>un site web dédié</li>
</ul>

<p>Les documents bureautique sont bien adaptés à la documentation de procédures, ou de spécifications. Cependant, ils souffrent de nombreux défauts comme le manque d’archivage des modifications, une recherche compliquée, un fort liant entre le format et le contenu et sont souvent portés par des formats propriétaires (le fameux <code class="highlighter-rouge">.docx</code>).</p>

<p>Les référentiels de type <em>wiki</em> répondent au problèmes de recherche et d’archivage des historiques de modifications. Cependant, ils nécessitent souvent une infrastructure avec une base de données, et ont donc un coût d’hébergement et de maintenance.</p>

<p>Le cas du site web statique dédié est le plus adapté à un projet open-source. Le site sera exposé sur internet, aidant à mettre en visibilité le projet. Un site web statique nécessite un hébergement minimum, sans base de données, et sera donc plus simple à mettre en place.</p>

<!--END_SUMMARY-->

<h1 id="documentation-as-code"><em>documentation-as-code</em></h1>

<p>Pour encourager les développeurs à rédiger plus de documentation, il est intéressant de considérer l’approche <em>documentation-as-code</em>.
Cette approche s’appuie sur les process et outils de développement pour proposer aux développeurs un moyen moderne d’écrire et publier leur documentation.</p>

<p>Dans un processus de <em>documentation-as-code</em>, les développeurs rédigent et archivent la documentation au même endroit que le code source, dans un repository <em>git</em>.
Cela permet de fournir une documentation plus précise, et plus à jour. Les mises à jour de documentation sont effectuées en même temps que les mises à jour du code source.</p>

<p>Un site web de documentation pourra alors être généré à partir des documents rédigés par les développeurs. Ce site pourra être publié avec des chaînes d’intégration continue.</p>

<h2 id="les-formats-asciidoc-et-markdown">Les formats <em>asciidoc</em> et <em>markdown</em></h2>

<p>En <em>documentation-as-code</em>, la documentation sera écrite dans un format simple, déjà maitrisé par les développeurs. Un des avantages principaux est que ces formats peuvent être édités dans les IDE que les développeurs utilisent déjà.</p>

<p>Les deux formats les plus utilisés sont l’<em>asciidoc</em> et le <em>markdown</em>.</p>

<p>L’intérêt d’utiliser ces formats est multiple:</p>

<ul>
  <li>le développeur se concentre sur la rédation du contenu plutôt que sur le formattage des données</li>
  <li>la documentation peut être archivée comme du code source, voire dans le même repository que le projet</li>
  <li>ces formats sont simples d’utilisation, même pour des personnes ayant peu ou pas de connaissances techniques</li>
</ul>

<h2 id="les-générateurs-de-sites-web-statiques">Les générateurs de sites web statiques</h2>

<p>Des fichiers <em>markdown</em> ou <em>asciidoc</em> sur un repository <em>git</em> peuvent parfois être suffisant. <em>Gitlab</em> et <em>Github</em> sont capables d’afficher des fichiers <em>markdown</em> ou <em>asciidoc</em> directement dans leur interface. C’est le cas par exemple des fameux <code class="highlighter-rouge">README.md</code> qu’on retrouve sur une majorité de projets.
Cet usage peut suffire pour documenter une librairie ou un projet simple. 
D’autres projets, plus compliqués, auront plus de pages de documentation, et des besoins de personnalisation, c’est là où un générateur de site web statique sera utile.</p>

<h3 id="asciidoc-et-asciidoctor"><em>asciidoc</em> et <em>asciidoctor</em></h3>

<p>La suite de cet article ne décrira pas comment mettre en place <em>asciidoc</em> et <em>asciidoctor</em>, mais il était important de mentionner ces outils, qui sont utilisés par de nombreux projets.</p>

<p><em>asciidoc</em>, couplé au générateur <em>asciidoctor</em> permet directement de générer des pages <em>HTML</em> statiques à partir de un ou plusieurs fichiers de documentation source.
Les pages <em>HTML</em> générées peuvent alors être publiées directement.
C’est ce qui est utilisé par le framework Java <em>Spring</em> par exemple.</p>

<p>Voici à titre d’exemple la <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/" target="_blank">documentation générée pour le framework Spring</a> , à partir des documents <em>asciidoc</em> disponible sur <em>Github</em>:</p>

<p><img src="/articles/common/mkdocs-material//mkdocs-spring.png" alt="" /></p>

<p>Les sources sont visibles sur le <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-docs/src/docs/asciidoc" target="_blank"><em>Github</em> de <em>Spring</em></a>.</p>

<p><em>Spring</em> utilise donc <em>asciidoctor</em> pour générer leur documentation dans 3 formats différents:</p>

<ul>
  <li>un pdf complet</li>
  <li>une page HTML complète (autonome)</li>
  <li>un ensemble de pages HTMLs liées entre elles</li>
</ul>

<h3 id="markdown-et-mkdocs"><em>markdown</em> et <em>MkDocs</em></h3>

<p>Bien qu’<em>asciidoctor</em> propose de générer plusieurs formats, d’autres générateurs compatibles Markdown existent:</p>

<ul>
  <li><a href="https://jekyllrb.com/" target="_blank"><em>Jekyll</em></a>, est plutôt orienté blogging</li>
  <li><a href="https://gohugo.io/" target="_blank"><em>Hugo</em></a>, est orienté site web généraliste</li>
  <li><a href="https://www.mkdocs.org/" target="_blank"><em>MkDocs</em></a>, est orienté documentation</li>
</ul>

<p>Ces générateurs amènent une structure de site web classique, avec une navigation à plusieurs niveaux de menus, et souvent des champs de recherche.</p>

<p>Parmis ces 3 solutions, <em>MkDocs</em> est le plus orienté documentation, c’est cet outil que nous allons mettre en place dans la suite de cet article.</p>

<h1 id="mise-en-place-de-mkdocs">Mise en place de <em>MkDocs</em></h1>

<p>Nous allons voir dans la suite de cet article:</p>

<ul>
  <li>l’installation et la configuration de <em>MkDocs</em></li>
  <li>l’utilisation et la configuration d’un thème et sa customisation (logo, couleurs)</li>
  <li>la rédaction de quelques pages</li>
  <li>la publication en site statique avec <em>Github Actions</em> &amp; <em>Github Pages</em></li>
</ul>

<h1 id="création-du-projet-de-documentation">Création du projet de documentation</h1>

<p>La documentation peut être créée comme un repository Git dédié, ou comme un répertoire d’un repository existant, dans le cas d’une approche <em>mono-repo</em> par exemple.</p>

<p>C’est cette deuxième solution que nous allons suivre.
Dans un projet existant, on commence par créer un répertoire <code class="highlighter-rouge">docs</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>docs/
</code></pre></div></div>

<p>La création du squelette de documentation peut se faire avec le <em>CLI</em> (pour Command Line Interface) de <em>MkDocs</em> et la commande <a href="https://www.mkdocs.org/user-guide/cli/#mkdocs-new"><code class="highlighter-rouge">mkdocs new</code></a>, ou simplement en initialisant quelques fichiers à la main.</p>

<p>Nous allons créer l’arborescence suivante:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.
├─ docs/
│  └─ index.md
└─ mkdocs.yml
</code></pre></div></div>

<p>Le contenu de notre fichier <code class="highlighter-rouge">mkdocs.yml</code> minimal est le suivant:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">site_name</span><span class="pi">:</span> <span class="s">Galactic Empire</span>
</code></pre></div></div>

<p>Pour référence, la <a href="https://www.mkdocs.org/user-guide/configuration/" target="_blank">documentation de <em>MkDocs</em></a> liste les paramètres de configuration qui peuvent être modifiés dans le fichier <code class="highlighter-rouge">mkdocs.yml</code>.</p>

<p>Un fichier <code class="highlighter-rouge">docs/index.md</code> permet de servir de page d’accueil:</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh"># Documentation</span>

Bienvenue sur la documentation de l'Empire Galactique
</code></pre></div></div>

<h1 id="démarrage-de-mkdocs-en-mode-preview">Démarrage de <em>MkDocs</em> en mode preview</h1>

<p><em>MkDocs</em> est écrit en python, et peut être installé en quelques commandes. La <a href="https://www.mkdocs.org/user-guide/installation/#installing-mkdocs" target="_blank">procédure d’installation</a> est simple:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>mkdocs
</code></pre></div></div>

<p>Il existe également des images <em>Docker</em> dédiées, qui seront utiles pour l’automatisation avec <em>Github Actions</em> ou <em>Gitlab CI</em> pour la publication, bien que nous allons nous en passer.</p>

<p>Le démarrage du site, en mode <em>preview</em>, se fait en une commande:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mkdocs serve
INFO     -  Building documentation...
INFO     -  Cleaning site directory
INFO     -  Documentation built <span class="k">in </span>0.15 seconds
INFO     -  <span class="o">[</span>09:32:45] Watching paths <span class="k">for </span>changes: <span class="s1">'docs'</span>, <span class="s1">'mkdocs.yml'</span>
INFO     -  <span class="o">[</span>09:32:45] Serving on http://127.0.0.1:8000/
</code></pre></div></div>

<p>Le site web est construit, et disponible en local:</p>

<p><img src="/articles/common/mkdocs-material//create-docs-website-preview.png" alt="" /></p>

<h1 id="ajout-dun-thème--customisation">Ajout d’un thème &amp; customisation</h1>

<p>Le thème par défaut n’est pas très élégant.
Plusieurs thèmes existent, et il est possible de créer le sien, à condition de savoir un peu développer en HTML/CSS.</p>

<p>Néanmoins, un thème populaire est <a href="https://squidfunk.github.io/mkdocs-material" target="_blank"><em>Material for MkDocs</em></a> (13k stars sur <em>Github</em>). Ce thème propose une interface épurée, personnalisable, et le support d’extensions à <em>markdown</em>.</p>

<p>L’installation du thème se fait en une ligne de commande:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>mkdocs-material
</code></pre></div></div>

<p>Pour utiliser notre thème, il faut le préciser dans le fichier <code class="highlighter-rouge">mkdocs.yml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">site_name</span><span class="pi">:</span> <span class="s">Galactic Empire</span>

<span class="c1"># configuration du thème</span>
<span class="na">theme</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">material</span>
</code></pre></div></div>

<p>Nous allons maintenant un peu customiser notre thème.
Toutes les instructions sont disponible dans la <a href="https://squidfunk.github.io/mkdocs-material/setup/changing-the-colors/" target="_blank">documentation de <em>Material for Mkdocs</em></a>:</p>

<h2 id="le-logo">Le logo</h2>

<p>Pour changer le logo, il faut indiquer quel fichier utiliser dans la configuration.
Pour notre exemple, je suis allé chercher un logo libre de droits sur le site web <a href="https://pngrepo.com" target="_blank">https://pngrepo.com</a>, et je l’ai positionné dans un répertoire <code class="highlighter-rouge">docs/assets</code> que j’ai créé pour l’occasion:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.
├── docs
│   ├── assets
│   │   └── death-star.png
│   └── index.md
└── mkdocs.yml
</code></pre></div></div>

<p>Le logo est ensuite référencé dans le fichier de configuration:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">site_name</span><span class="pi">:</span> <span class="s">Galactic Empire project</span>

<span class="c1"># configuration du thème</span>
<span class="na">theme</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">material</span>
  <span class="na">logo</span><span class="pi">:</span> <span class="s">assets/death-star.png</span>
</code></pre></div></div>

<p>À noter que le répertoire <em>assets</em> déclaré dans la configuration est bien relatif au répertoire <em>docs</em>.</p>

<h2 id="les-couleurs">Les couleurs</h2>
<p>La configuration des couleurs passe par une déclaration CSS, si on veut sortir des couleurs proposées dans la palette de couleurs par défaut.
Un fichier css peut surcharger l’ensemble des variables de couleurs prédéfinies. La liste des variables est disponible dans le <a href="https://github.com/squidfunk/mkdocs-material/blob/master/src/assets/stylesheets/main/_colors.scss" target="_blank">fichier de définition des couleurs</a> du code source de <em>Material for MkDocs</em>.</p>

<p>Pour surcharger les couleurs principales, il suffit donc de les re-déclarer dans un fichier <code class="highlighter-rouge">.css</code>, de cette manière:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">:root</span> <span class="p">{</span>
  <span class="py">--md-primary-fg-color</span><span class="p">:</span> <span class="m">#394A59</span><span class="p">;</span>
  <span class="py">--md-accent-fg-color</span><span class="p">:</span>  <span class="m">#556567</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Le fichier <code class="highlighter-rouge">.css</code> doit être déposé où l’on souhaite. Ici, nous avons créé un répertoire <code class="highlighter-rouge">docs/stylesheets</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.
├── docs
│   ├── assets
│   │   └── death-star.png
│   ├── index.md
│   └── stylesheets
│       └── galactic-empire.css
└── mkdocs.yml
</code></pre></div></div>

<p>Enfin, le fichier <code class="highlighter-rouge">.css</code> doit être référencé dans la configuration de notre site:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">site_name</span><span class="pi">:</span> <span class="s">Galactic Empire project</span>

<span class="c1"># configuration du thème</span>
<span class="na">theme</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">material</span>
  <span class="na">logo</span><span class="pi">:</span> <span class="s">assets/death-star.png</span>

<span class="na">extra_css</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">stylesheets/galactic-empire.css</span>
</code></pre></div></div>

<p>Et voici notre site avec le thème et sa customisation.</p>

<p><img src="/articles/common/mkdocs-material//create-docs-website-theme.png" alt="" /></p>

<h1 id="lajout-de-contenu">L’ajout de contenu</h1>
<p>L’ajout de contenu passe maintenant simplement par l’ajout de nouveaux fichiers <em>markdown</em> dans le répertoire de documentation.</p>

<p>Voici un exemple de page de contenu supplémentaire:</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">title</span><span class="pi">:</span> <span class="s">Organisation</span>
<span class="na">author</span><span class="pi">:</span> <span class="s">Darth Vader</span>
<span class="nn">---</span>

<span class="gh"># Organisation de l'Empire Galactique</span>

L'Empire Galactique est dirigé par l'Empereur Palpatine.

Son bras droit est le seigneur Vador.

Le Grand Moff Tarkin est le gouverneur régional de la Bordure Extérieur.
Il est à la tête du projet "Étoile de la mort", et son commandant.
</code></pre></div></div>

<p>L’en-tête du fichier est au format <em>Front Matter</em>, qui a été popularisé par <a href="https://jekyllrb.com/docs/front-matter/" target="_blank"><em>Jekyll</em></a>.</p>

<p>Le rendu est le suivant:</p>

<p><img src="/articles/common/mkdocs-material//create-docs-website-content-page.png" alt="" /></p>

<p>Notez que :</p>

<ul>
  <li>le titre de la page est celui du premier header Markdown <code class="highlighter-rouge">#</code></li>
  <li>dans la navigation de gauche, le titre utilisé est celui du bloc de description de la page <em>Front Matter</em>.</li>
  <li>le nom de l’auteur apparaît dans les méta-données de la page générée:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
  ...
  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"author"</span> <span class="na">content=</span><span class="s">"Darth Vader"</span><span class="nt">&gt;</span>
  ...
<span class="nt">&lt;/head</span>      
</code></pre></div></div>

<h1 id="publication-avec-github-actions--github-pages">Publication avec <em>Github Actions</em> &amp; <em>Github Pages</em></h1>

<p>Maintenant que notre site web est fonctionnel, nous allons le mettre à disposition sur le web avec <em>Github Pages</em>.</p>

<p>La création d’un repository <em>Github</em> et les bases de <em>Github Actions</em> sont en dehors du périmètre de cet article.</p>

<p>La construction du site web se fait avec la commande <code class="highlighter-rouge">mkdocs build</code>.
L’exécution de cette commande produit un nouveau répertoire <code class="highlighter-rouge">site</code> qui contient le site web généré:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mkdocs build 
INFO     -  Cleaning site directory
INFO     -  Building documentation to directory: ekit3/mkdocs-website-sample/site
INFO     -  Documentation built <span class="k">in </span>0.16 seconds
</code></pre></div></div>
<p>Nous allons donc utiliser cette commmande pour générer notre site web à publier.</p>

<p>Voici un workflow <em>Github Actions</em>, qui installe le langage <em>Python</em>, <em>MkDocs</em> et <em>Material for MkDocs</em>, et construit notre site:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Build &amp; Publish site</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">main"</span> <span class="pi">]</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">main"</span> <span class="pi">]</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up Python $</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-python@v3</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install dependencies</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">python -m pip install mkdocs</span>
        <span class="s">python -m pip install mkdocs-material</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build site</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">mkdocs build</span>
</code></pre></div></div>

<p>L’étape suivante consiste à publier le site construit sur <em>Github Pages</em>, ce qui se fait avec 2 actions dédiées.</p>

<p>L’action <code class="highlighter-rouge">upload-pages-artifact</code> permet de sélectionner un répertoire à envoyer à Github Pages, en l’occurence, notre répertoire <code class="highlighter-rouge">site</code>, qui contient notre site web.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload Pages Artifact</span>
  <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-pages-artifact@v1</span>
  <span class="na">with</span><span class="pi">:</span>
    <span class="na">path</span><span class="pi">:</span> <span class="s">./site</span>
</code></pre></div></div>

<p>Cette action peut être ajoutée au job <em>build</em> décrit plus haut.</p>

<p>Enfin, l’action <code class="highlighter-rouge">deploy-pages</code> permet d’exécuter le déploiement, nous l’ajoutons dans un job séparé:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="pi">[</span><span class="nv">...</span><span class="pi">]</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="s">build</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">permissions</span><span class="pi">:</span>
      <span class="na">pages</span><span class="pi">:</span> <span class="s">write</span>
      <span class="na">id-token</span><span class="pi">:</span> <span class="s">write</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">github-pages</span>
      <span class="na">url</span><span class="pi">:</span> <span class="s">$</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to GitHub Pages</span>
      <span class="na">id</span><span class="pi">:</span> <span class="s">deployment</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/deploy-pages@v1</span>
</code></pre></div></div>

<p>Le fichier final complet est disponible sur <a href="https://github.com/ekit3/mkdocs-website-sample/blob/main/.github/workflows/publish.yml" target="_blank">le repository <em>Github</em></a> contenant le code source de cet article.</p>

<p>À noter que le déploiement avec <em>Github Pages</em> doit être activé dans le repository <em>Github</em>, et que le repository doit être public :</p>

<p><img src="/articles/common/mkdocs-material//create-docs-website-github-pages.png" alt="" /></p>

<p>Une fois le fichier Github Actions publié, le workflow pourra s’exécuter, et publier le site web:</p>

<p><img src="/articles/common/mkdocs-material//create-docs-website-workflow.png" alt="" /></p>

<p>Le résultat final est visible <a href="https://ekit3.github.io/mkdocs-website-sample/" target="_blank">via ce lien</a>.</p>

<p>Le code source de cet article est disponible dans notre repository <em>Github</em> <a href="https://github.com/ekit3/mkdocs-website-sample" target="_blank">mkdocs-website-sample</a></p>

<h1 id="conclusion">Conclusion</h1>

<p>En conclusion, nous avons vu les principes de documentation-as-code, et qu’il était très simple de publier une documentation sous la forme d’un site web. 
Nous avons également vu comment utiliser le format <em>markdown</em>, couplé à l’outil <em>MkDocs</em> et le thème <em>Material for MkDocs</em> pour générer un site web et le personnaliser.
Enfin, nous avons vu comment utiliser <em>Github Actions</em> et <em>Github Pages</em> pour publier notre site de documentation sur internet.</p>

<p><em>MkDocs</em>, couplé à un hébergement avec <em>Gitlab Pages</em> ou <em>Github Pages</em>, permet de générer un site web en quelques étapes rapides.
Cela en fait l’outil idéal pour documenter un projet open-source ou interne.</p>

<h1 id="liens">Liens</h1>

<ul>
  <li><a href="https://www.mkdocs.org/" target="_blank">Documentation</a> de <em>MkDocs</em></li>
  <li><a href="https://squidfunk.github.io/mkdocs-material/" target="_blank">Documentation</a> de <em>Material for MkDocs</em></li>
  <li><a href="https://squidfunk.github.io/mkdocs-material/setup/changing-the-colors/" target="_blank">La customisation</a> de <em>Material for MkDocs</em> (couleurs, fonts, icônes)</li>
  <li>L’icône <em>Death Star</em> utilisée pour le site généré sur <a href="https://www.pngrepo.com/svg/275952/death-star-star-wars" target="_blank">pngrepo.com</a></li>
  <li>Les actions Github utilisées:
    <ul>
      <li><a href="https://github.com/actions/upload-pages-artifact" target="_blank">upload-pages-artifact</a></li>
      <li><a href="https://github.com/actions/deploy-pages" target="_blank">deploy-pages</a></li>
    </ul>
  </li>
  <li>Le <a href="https://github.com/ekit3/mkdocs-website-sample" target="_blank">code source</a> associé à cet article</li>
</ul>
</span>
      </div>
    </article>
  </div>

            <footer class="footer">
    <div class="footer-content">
        <h4>Qui sommes nous :</h4>
        <p>"Nos experts vous accompagnent sur la réalisation et l’amélioration de vos systèmes d’information tout en étant en immersion dans vos équipes."</p>
    </div>
    <div class="footer-content">
        <h4>La plus-value proposée :</h4>
        <p>
            vous permettre de prendre du recul sur l’utilisation technologique afin qu’elle soit adaptée à votre contexte.
        </p>
    </div>
    <div class="footer-content">
        <h4>Nous suivre :</h4>
        <div class="social">
            <a href="https://www.linkedin.com/company/ekite/" target="_blank"><img alt="linkedin" src="/assets/images/logo-linkedin.png"></a>
            <a href="https://twitter.com/Ekite_" target="_blank"><img alt="Twitter" src="/assets/images/logo-twitter.png"></a>
            <a href="https://github.com/ekit3" target="_blank"><img alt="Github" src="/assets/images/logo-github.png"></a>
        </div>
    </div>
</footer>
 <div class="copyright">
    <span>Ekite © Copyright 2021. Tous droits réservés</span>
    <a href="/mentions">Mentions légales</a>
    <a href="https://github.com/Ekawa-fr" target="_blank">Réalisé par Ekawa</a>
</div>

        </main>
        <script src="/assets/libs/jquery-3.5.1.min.js"></script>
        <script src="/scripts/index.js"></script>
        <script src="/assets/libs/bootstrap.bundle.min.js"></script>
        <script src="/assets/libs/select2.full.min.js"></script>
        <script>
            if (window.Worker) {
                navigator.serviceWorker.register('/worker.js').then(function(registration) {
                    // console.log('ServiceWorker registration successful with scope:',  registration.scope);
                }).catch(function(error) {
                    console.warn('ServiceWorker registration failed:', error);
                });
            }
        </script>
    </body>
</html>
